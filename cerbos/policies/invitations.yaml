apiVersion: api.cerbos.dev/v1

resourcePolicy:
  version: default
  resource: invitations
  rules:
    - actions:
        - 'create'
      effect: EFFECT_ALLOW
      roles:
        - ADMIN
        - OWNER

    - actions:
        - 'read'
      effect: EFFECT_ALLOW
      roles:
        - ADMIN
        - OWNER
        - MEMBER

    - actions:
        - 'delete'
      effect: EFFECT_ALLOW
      roles:
        - ADMIN
        - OWNER
      condition:
        match:
          expr: request.resource.attr.author == request.principal.id
